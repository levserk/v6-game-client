(function () {define('require-cnf',[],function() {
    require.config({
        baseUrl: 'js',
        urlArgs: 'bust=' + (+new Date()),
        paths: {
            jquery: 'lib/jquery-2.1.1.min',
            underscore: 'lib/underscore-min',
            backbone: 'lib/backbone-min',
            text: 'lib/text',
            tpls: '../tpl',
            client: 'modules/client',
            EE: 'lib/EventEmitter.min',
            'jquery-ui': 'lib/jquery-ui'
        },
        shim: {
            backbone: {
                deps: ['underscore', 'jquery'],
                exports: 'Backbone'
            },
            'jquery-ui': {
                exports: "$",
                deps: ['jquery']
            },
            EE: {
                exports: 'EventEmitter'
            }
        }
    });
});
require(['require-cnf'], function() {
    require(['jquery-ui'], function() {
        require(['client', 'views/user_list', 'views/dialogs'], function(Client, userListView, dialogsView) {
            // TODO client is global(make singleton)
            // TODO css images not found)
            

            console.log('main;', new Date(), 'ready');

            document.cookie = 'userId='+(Math.floor(Math.random()*100000))+"; path=/;";

            window.client = new Client({domain:'localhost'});

            client.init();
            _initViews();
            $('#endGameButton').on('click', function() {
                client.gameManager.leaveGame();
            });


            function _initViews() {
                new userListView({el: $('#userList')});
                dialogsView.init();
            }
        });
    });

});
define("js/main.js", function(){});

}());